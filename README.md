![Bingo](https://github.com/ruckii/yyapp/assets/1169824/5d9961d5-a9f1-41ae-8630-14673ecf3488)

# Bingo —Å–µ—Ä–≤–∏—Å "–ö—Ä–æ–≤—å –∏ —Å–ª—ë–∑—ã"

*–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å Young&&Yandex –∫–æ–º–∞–Ω–¥–µ –∑–∞ –±–µ—Å—Ü–µ–Ω–Ω—ã–π –æ–ø—ã—Ç!*

# –ó–∞–¥–∞–Ω–∏–µ

1 –¥–µ–∫–∞–±—Ä—è, –≤ 23:59 –ø–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º –Ω–∞—à –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å - API —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å–µ—Å—Å–∏–π –Ω–∞—à–µ–≥–æ –æ–Ω–ª–∞–π–Ω –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞ ¬´–§–∏–ª—å–º–æ–ø–æ–∏—Å–∫¬ª.

–î–∞—Ç—É –∑–∞–ø—É—Å–∫–∞ —Å–¥–≤–∏–Ω—É—Ç—å –Ω–µ–ª—å–∑—è, –Ω–∞—à PR —É–∂–µ –∞–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ–¥–≤–∏–≥–∞–µ—Ç —ç—Ç–æ—Ç –∑–∞–ø—É—Å–∫. –û—Ç —Ç–µ–±—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ–¥—É–∫—Ç–æ–≤—É—é –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—é —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.

–ù–∞—à –ø–æ–¥—Ä—è–¥—á–∏–∫ "Horns&Hooves Soft inc" –ø–∏—à–µ—Ç –¥–ª—è –Ω–∞—Å —ç—Ç–æ—Ç –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å. –ù–µ–¥–µ–ª—é –Ω–∞–∑–∞–¥ –ø–æ–¥—Ä—è–¥—á–∏–∫ –ø—Ä–æ–≤—ë–ª –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é. –ù–∞ –Ω–µ–π –æ–Ω –ø–æ–∫–∞–∑–∞–ª –ø–æ—á—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∏ –ø—Ä–µ–∑–µ–Ω—Ç–æ–≤–∞–ª HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ GET /ping –∫–æ–¥–æ–º 200, –µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –∫–æ–¥–æ–º 500, –µ—Å–ª–∏ –Ω–µ—Ç.

–ú—ã –ø–æ–ø—Ä–æ—Å–∏–ª–∏ –≤–Ω–µ—Å—Ç–∏ –Ω–µ–±–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å `GET /long_dummy` –≤ 75% —Å–ª—É—á–∞–µ–≤ —Ä–∞–±–æ—Ç–∞–ª –±—ã—Å—Ç—Ä–µ–µ —Å–µ–∫—É–Ω–¥—ã, –ø—Ä–∏ —ç—Ç–æ–º –Ω–∞—Å —É—Å—Ç—Ä–æ–∏—Ç –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–µ —Å—Ç–∞—Ä—à–µ –º–∏–Ω—É—Ç—ã. –ù–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ –æ–Ω —Ä–∞–±–æ—Ç–∞–ª –¥–æ–ª—å—à–µ. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø–æ–¥—Ä—è–¥—á–∏–∫ —Å–æ–æ–±—â–∏–ª, —á—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–Ω–µ—Å—Ç–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É–¥–æ–±—Å—Ç–≤–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏, –∞ —Ç–∞–∫ –∂–µ –ø–æ—á–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –±–∞–≥–æ–≤ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–±–æ—Ç–µ.

–í—á–µ—Ä–∞ –¥–æ–ª–∂–Ω–∞ –±—ã–ª–∞ —Å–æ—Å—Ç–æ—è—Ç—å—Å—è –ø—Ä–∏—ë–º–∫–∞, –Ω–æ –ø–æ–¥—Ä—è–¥—á–∏–∫ –Ω–∞ —Å–≤—è–∑—å –Ω–µ –≤—ã—à–µ–ª –∏ –ø–µ—Ä–µ—Å—Ç–∞–ª –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –ø–∏—Å—å–º–∞, —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∑–≤–æ–Ω–∫–∏. –ù–∞–º —É–¥–∞–ª–æ—Å—å –≤—ã—è—Å–Ω–∏—Ç—å, —á—Ç–æ —É –ø–æ–¥—Ä—è–¥—á–∏–∫–∞ –≤–æ–∑–Ω–∏–∫–ª–∏ —Å–µ—Ä—å—ë–∑–Ω—ã–µ —Ñ–æ—Ä—Å-–º–∞–∂–æ—Ä–Ω—ã–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞. –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ø–æ–ª—É—á–∏—Ç—Å—è –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Ä–∞–Ω—å—à–µ 2 –¥–µ–∫–∞–±—Ä—è, —Ç–æ –µ—Å—Ç—å —É–∂–µ –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–π –¥–∞—Ç—ã –∑–∞–ø—É—Å–∫–∞. –ü–æ–¥—Ä—è–¥—á–∏–∫ –Ω–µ —É—Å–ø–µ–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é, –∏ –Ω–µ —Å–º–æ–≥ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —É –Ω–∞—Å —Å–≤–æ—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Å—Ä–æ–∫, –∫–∞–∫ —Ä–∞–Ω–µ–µ –æ–±–µ—â–∞–ª. –¢–æ—Ç —Å—Ç–µ–Ω–¥, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è, —É–∂–µ —É—Å–ø–µ–ª–∏ —Ä–∞–∑–æ–±—Ä–∞—Ç—å. –ö —Å—á–∞—Å—Ç—å—é, —É –Ω–∞—à–µ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –æ—Å—Ç–∞–ª—Å—è email —Å –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –Ω–∞ –¥–µ–º–æ.

https://storage.yandexcloud.net/final-homework/bingo ‚Äì –≤–æ—Ç —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –±–∏–Ω–∞—Ä–Ω–∏–∫.

–¢–≤–æ—è –∑–∞–¥–∞—á–∞ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—É—é –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ –∏–º–µ—é—â–µ–≥–æ—Å—è –±–∏–Ω–∞—Ä–Ω–∏–∫–∞ –¥–æ –¥–∞—Ç—ã –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∞. –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤ 60 RPS, –ø–∏–∫–æ–≤–∞—è –≤ 120 RPS.

–í —ç—Ç—É –ø—è—Ç–Ω–∏—Ü—É, 24 –Ω–æ—è–±—Ä—è, –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ –æ—Ç–ø—É—Å–∫–∞ –Ω–∞—à —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫ –ü–µ—Ç—è, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–ª —Å –ø–æ–¥—Ä—è–¥—á–∏–∫–æ–º –∏ —É–º–µ–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –û–Ω —Å–º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–≤–æ—é –∏ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—é –∏ –ø–æ–¥—Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Å –Ω–µ–π –Ω–µ —Ç–∞–∫, —á—Ç–æ–±—ã —Ç–µ–±–µ –±—ã–ª–æ —É–¥–æ–±–Ω–µ–µ –≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º—É –∑–∞–ø—É—Å–∫—É.

–ü–µ—Ç—è –∏–Ω—Ç—Ä–æ–≤–µ—Ä—Ç, –Ω–µ –ª—é–±–∏—Ç –∂–∏–≤–æ–µ –æ–±—â–µ–Ω–∏–µ, –ø–æ—ç—Ç–æ–º—É –æ–Ω –æ–±–µ—â–∞–ª —Å–¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∫—É –∏ –ø–æ–º–æ–≥–∞—Ç—å —Ç–µ–±–µ —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ - https://devops.yactf.ru
–ü–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –æ–Ω –∏ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ –æ —Ç–æ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–µ–±–µ —É–¥–∞–ª–æ—Å—å —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è (–≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è –≤–∞–∂–Ω–æ—Å—Ç–∏)

### –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

C–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –Ω–∞ –¥–≤—É—Ö –Ω–æ–¥–∞—Ö. –û—Ç–∫–∞–∑ –ª—é–±–æ–π –∏–∑ –Ω–∏—Ö –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–∑–∞–º–µ—Ç–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –î–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ—Å–∞–¥–∫–∞ –ø–æ RPS –¥–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–æ–º–µ–Ω—Ç –æ—Ç–∫–∞–∑–∞ –ª—é–±–æ–π –∏–∑ –Ω–æ–¥. –ü—Ä–∏ –∂–∏–≤–æ—Å—Ç–∏ –æ–±–µ–∏—Ö –Ω–æ–¥, –∏–Ω—Å—Ç–∞–ª—è—Ü–∏—è –æ–±—è–∑–∞–Ω–∞ –≤—ã–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–∏–∫–æ–≤—É—é –Ω–∞–≥—Ä—É–∑–∫—É. –¢–∞–∫ –∂–µ –Ω—É–∂–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ª—é–±–æ–π –æ—Ç–∫–∞–∑–∞–≤—à–µ–π –Ω–æ–¥—ã –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ –º–∏–Ω—É—Ç—É.

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| Method | URL | Parameters | Duration | Error rate |
|--|--|--|--|--|
| POST | /operation | {"operation": <operation_id: integer>} | 400 ms 90% @ 120 RPS | < 1% |
| GET | /db_dummy |  | 400 ms 90% @ 120 RPS | < 1% |
| GET | /api/movie/ | {id = 1..29019} | 400 ms 90% @ 120 RPS | < 1% |
| GET | /api/customer/ | {id = 1..500.000} | 400 ms 90% @ 120 RPS | < 1% |
| GET | /api/session/ | {id = 1..5.000.000} | 400 ms 90% @ 120 RPS | < 1% |
| GET | /api/movie |  | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–µ—Ç, –ø–ª–∞–Ω–∏—Ä—É–µ–º –¥–µ–ª–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ç–∞–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. | <1% |
| GET | /api/customer |  | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–µ—Ç, –ø–ª–∞–Ω–∏—Ä—É–µ–º –¥–µ–ª–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ç–∞–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ | <1% |
| GET | /api/session |  | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏  –æ—Ç–≤–µ—Ç–∞ –Ω–µ—Ç, –ø–ª–∞–Ω–∏—Ä—É–µ–º –¥–µ–ª–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ç–∞–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. | <5% |
| POST | /api/session | {"start_time":"2021-12-09T16:12:52.059188Z", "customer_id":100, "movie_id":500} | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ  –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –∏ RPS –Ω–µ—Ç. | <1% |
| DELETE | /api/session/ | {id} | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ  –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –∏ RPS –Ω–µ—Ç. | <1% |

- –°–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–∂–∏–≤–∞—Ç—å –ø–∏–∫–æ–≤—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤ 120 RPS –≤ —Ç–µ—á–µ–Ω–∏–µ 1 –º–∏–Ω—É—Ç—ã, —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≤ 60 RPS.
- –ó–∞–ø—Ä–æ—Å—ã POST /operation {"operation": <operation_id: integer>} –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ 400 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –≤ 90% —Å–ª—É—á–∞–µ–≤ –ø—Ä–∏ 120 RPS, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ –±–æ–ª–µ–µ 1% –æ—à–∏–±–æ–∫.
- –ó–∞–ø—Ä–æ—Å—ã GET /db_dummy –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ 400 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –≤ 90% —Å–ª—É—á–∞–µ–≤ –ø—Ä–∏ 120 RPS, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ –±–æ–ª–µ–µ 1% –æ—à–∏–±–æ–∫.
- –ó–∞–ø—Ä–æ—Å—ã GET /api/movie/{id} –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ 400 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –≤ 90%  —Å–ª—É—á–∞–µ–≤ –ø—Ä–∏ 120 RPS, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ –±–æ–ª–µ–µ 1% –æ—à–∏–±–æ–∫.
- –ó–∞–ø—Ä–æ—Å—ã GET /api/customer/{id} –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ 400 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –≤ 90% —Å–ª—É—á–∞–µ–≤ –ø—Ä–∏ 120 RPS, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ –±–æ–ª–µ–µ 1% –æ—à–∏–±–æ–∫.
- –ó–∞–ø—Ä–æ—Å—ã GET /api/session/{id} –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ 400 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –≤ 90%  —Å–ª—É—á–∞–µ–≤ –ø—Ä–∏ 120 RPS, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ –±–æ–ª–µ–µ 1% –æ—à–∏–±–æ–∫.
- –ó–∞–ø—Ä–æ—Å—ã GET /api/movie –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ –±–æ–ª–µ–µ 1% –æ—à–∏–±–æ–∫. –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–µ—Ç, –ø–ª–∞–Ω–∏—Ä—É–µ–º –¥–µ–ª–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ç–∞–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
- –ó–∞–ø—Ä–æ—Å—ã GET /api/customer –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ –±–æ–ª–µ–µ 1% –æ—à–∏–±–æ–∫. –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–µ—Ç, –ø–ª–∞–Ω–∏—Ä—É–µ–º –¥–µ–ª–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ç–∞–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
- –ó–∞–ø—Ä–æ—Å—ã GET /api/session –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ –±–æ–ª–µ–µ 5% –æ—à–∏–±–æ–∫. –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏  –æ—Ç–≤–µ—Ç–∞ –Ω–µ—Ç, –ø–ª–∞–Ω–∏—Ä—É–µ–º –¥–µ–ª–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ç–∞–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
- –ó–∞–ø—Ä–æ—Å—ã POST /api/session –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ –±–æ–ª–µ–µ 1% –æ—à–∏–±–æ–∫. –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ  –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –∏ RPS –Ω–µ—Ç.
- –ó–∞–ø—Ä–æ—Å—ã DELETE /api/session/{id} –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ –±–æ–ª–µ–µ 1% –æ—à–∏–±–æ–∫. –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ  –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –∏ RPS –Ω–µ—Ç.

### –ó–∞–¥–∞—á–∏ —Å–æ –∑–≤—ë–∑–¥–æ—á–∫–æ–π

- C–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–ª –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –¥–æ–º–µ–Ω–µ –ø–æ https –ø—Ä–æ—Ç–æ–∫–æ–ª—É, –∏ –ø–æ http –±–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –Ω–∞ https  (–¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç).
- –°–¥–µ–ª–∞—Ç—å http3.
- –°–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å—ã GET /long_dummy –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ –æ—Ç–≤–µ—Ç –Ω–µ —Å—Ç–∞—Ä—à–µ 1 –º–∏–Ω—É—Ç—ã –∏ –æ—Ç–≤–µ—á–∞–ª–∏ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∑–∞ 1 —Å–µ–∫—É–Ω–¥—É –≤ 75% —Å–ª—É—á–∞–µ–≤.
- –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –≥—Ä–∞—Ñ–∏–∫–∏ RPS –∏ –æ—à–∏–±–æ–∫ –ø–æ –∫–∞–∂–¥–æ–º—É —ç–Ω–¥–ø–æ–∏–Ω—Ç—É.
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ devops –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –≤—ã —É—Å–ø–µ–ª–∏ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Ä–∞–Ω–µ–µ.

### –ù–µ–º–Ω–æ–∂–∫–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

- –î–ª—è –Ω–∞—Å –≤–∞–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–±–æ—Ç–∞—é—â—É—é –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—é, –∏ –º–µ–Ω–µ–µ –≤–∞–∂–Ω–æ –∫–∞–∫ —ç—Ç–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –±—ã–ª–∞ –æ–±–µ—Å–ø–µ—á–µ–Ω–∞. –ú—ã –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–µ —Ä–µ—à–µ–Ω–∏—è. –í –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ—à–µ–Ω–∏—è –ø–æ–º–∏–º–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ –º—ã —Ö–æ—Ç–∏–º —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ —ç—Ç–∞ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—è –±—ã–ª–∞ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞. –í –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ—á–∏–Ω–µ–Ω–∏–µ –Ω–∞ —Ç–µ–º—É "–∫–∞–∫ —è —ç—Ç–æ —Ä–∞–∑–≤–µ—Ä–Ω—É–ª —Ä—É–∫–∞–º–∏". –í –∏–¥–µ–∞–ª–µ –∂–µ, —ç—Ç–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π,  –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö devops –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å–ø–æ—Å–æ–±–µ–Ω —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å—é –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—é –ø–æ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–µ. –ú—ã –Ω–µ –æ–∂–∏–¥–∞–µ–º –æ—Ç –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞, –Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏ –ø—Ä–æ—á–∏—Ö —Ä–∞–≤–Ω—ã—Ö, –º—ã –æ—Ü–µ–Ω–∏–º –≤—ã—à–µ –Ω–µ–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö. –ü—Ä–∏ —ç—Ç–æ–º —Ä–∞–±–æ—Ç–∞—é—â–µ–µ –Ω–µ–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –±—É–¥–µ—Ç –∑–∞—Å—á–∏—Ç–∞–Ω–æ, –∞ –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–µ–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ - –Ω–µ—Ç;
- –ë–∏–Ω–∞—Ä–Ω–∏–∫ —É–º–µ–µ—Ç –≤ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Ç–∞–±–ª–∏—Ü—ã –∏ –Ω–∞–ø–æ–ª–Ω—è—Ç—å –∏—Ö —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –ù—É–∂–Ω–æ –µ–≥–æ —Ç–æ–ª—å–∫–æ –æ–± —ç—Ç–æ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–ø—Ä–æ—Å–∏—Ç—å, —É–≤–µ—Ä–µ–Ω –≤—ã —Å–º–æ–∂–µ—Ç–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –∫–∞–∫. –ù–∞–ª–∏—á–∏–µ –≤ –±–∞–∑–µ —ç—Ç–∏—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö - –æ–¥–Ω–æ –∏–∑  –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —É—Å–ª–æ–≤–∏–π —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è. –í—ã –º–æ–∂–µ—Ç–µ –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –≤ –±–∞–∑–µ –∏ –∏—Ö –∂–µ —É–¥–∞–ª—è—Ç—å. –û–¥–Ω–∞–∫–æ –Ω–µ —Å—Ç–æ–∏—Ç —É–¥–∞–ª—è—Ç—å –Ω–∏—á–µ–≥–æ –∏–∑ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Ç–∞–º –∑–∞–≤–µ–¥—ë–Ω–Ω–æ–≥–æ - —ç—Ç–æ –º–æ–∂–µ—Ç –Ω–µ –ø–æ–Ω—Ä–∞–≤–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–µ, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å –í–∞—à —Ä–µ–π—Ç–∏–Ω–≥;
- –í–∞–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è –≤ —Ç–æ–º, —á—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è. –¢–∞–π–º–∑–æ–Ω–∞ –Ω–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ  –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—à–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ—à–∞—Ç, —á—Ç–æ –≤—ã —Å—á–∏—Ç–µ—Ä–∏–ª–∏, –¥–æ–±–∞–≤–∏–≤ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–º, –≥–¥–µ –µ–≥–æ –±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ;
- –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä student_email - —Ç—É—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞—à email, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ - —ç—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–¥–∞–Ω–∏—è;
- –•—ç–ª—Å—á–µ–∫ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –µ—Å—Ç—å, –∂–∏–≤—ë—Ç –Ω–∞ GET /ping –∏ —Å–≤–æ—é —Ñ—É–Ω–∫—Ü–∏—é –≤—ã–ø–æ–ª–Ω—è–µ—Ç;
- –ú–æ–∂–µ—à—å –Ω–∞ —Å–≤–æ—ë —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ —É–ø–∞–∫–æ–≤–∞—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫ –≤ docker image, –ª–∏–±–æ —ç—Ç–æ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å;
- –î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ –Ø–Ω–¥–µ–∫—Å.–û–±–ª–∞–∫–µ - —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–π—Ç–µ—Å—å –≤ –æ–¥–Ω–æ–π –ê–ó;
- –î–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ RPS –∏ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ —Å–≤–æ–µ–π –∏–Ω—Å—Ç–∞–ª—è—Ü–∏–∏ –º–æ–∂–µ—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å wrk / ab;
- –î–ª—è SSL, http3 –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å reverse proxy, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä nginx;
- –ù–µ–∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ñ—Ç –Ω–µ —É–º–µ–µ—Ç –æ—Ç–¥–∞–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ prometheus, –¥–ª—è —Ç–∞–∫–æ–≥–æ —Å–æ—Ñ—Ç–∞ —Å–±–æ–∫—É —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç —á—Ç–æ-—Ç–æ, —á—Ç–æ —É–º–µ–µ—Ç —Å–æ–±—Ä–∞—Ç—å –∏ –æ—Ç–¥–∞—Ç—å –∑–∞ –Ω–µ–≥–æ —ç—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏. –ì—É–≥–ª–∏—Ç—å –ø–æ –∑–∞–ø—Ä–æ—Å—É "<–Ω–∞–∑–≤–∞–Ω–∏–µ —Å–æ—Ñ—Ç–∞> export metrics".

# –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ—à–µ–Ω–∏—è

## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è [~4 —á–∞—Åa]

```bash
wget https://storage.yandexcloud.net/final-homework/bingo
file bingo # --> bingo: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, with debug_info, not stripped
chmod +x bingo
./bingo # --> Hello world
./bingo --help
./bingo version
./bingo print_current_config
./bingo print_default_config
./bingo print_default_config > bingo.conf
./bingo --help
./bingo run_server --help
./bingo run_server # --> Crashed
sudo ./bingo run_server # --> Didn't your mom teach you not to run anything incomprehensible from root?
strace bingo
strace ./bingo
strace ./bingo get_current_config
strace ./bingo print_current_config # --> found failed access to file /opt/bingo/config.yaml
sudo mkdir /opt/bingo
./bingo print_default_config > config.yaml
sudo cp config.yaml /opt/bingo/
./bingo print_current_config
strace ./bingo run_server
#--‚úÇ--edit config.yaml--‚úÇ--
#--‚úÇ--run postgres in docker--‚úÇ--
./bingo prepare_db # --> ~20min
#--‚úÇ--install DBeaver (https://dbeaver.io/)--‚úÇ--
#--‚úÇ--inspect bingo DB structure--‚úÇ--
./bingo run_server # --> Still crashed
strace ./bingo run_server # --> found failed access to file /opt/bongo/logs/21b3c4259a/main.log
sudo mkdir -p /opt/bongo/logs/21b3c4259a/
sudo touch /opt/bongo/logs/21b3c4259a/main.log
./bingo run_server
strace ./bingo run_server # --> found insufficient rights on file
sudo chmod 0666 /opt/bongo/logs/21b3c4259a/main.log
./bingo run_server # --> 30sec startup
./bingo run_server &
tail -f /opt/bongo/logs/21b3c4259a/main.log
```

## –ü–æ—Ö–æ–¥ –≤ –∫–æ—Ä–µ–Ω—å
–°–º–æ—Ç—Ä–∏–º –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã:

```bash
ss -tunlp # --> ipv6 4922/tcp
```
–û—Ç–∫—Ä—ã–≤–∞–µ–º http://localhost:4922

–ù–∞—à—ë–ª –∫–æ–¥:

```
My congratulations.
You were able to start the server.
Here's a secret code that confirms that you did it.
--------------------------------------------------
code:         yoohoo_server_launched
--------------------------------------------------
```

## Web-proxy [1 –¥–µ–Ω—å]
–í—ã–±–∏—Ä–∞—é –ø—Ä–æ–∫—Å–∏, —Ä–∞–Ω–µ–µ —Å nginx —É–∂–µ —Å—Ç–∞–ª–∫–∏–≤–∞–ª—Å—è, —Ä–µ—à–∏–ª –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Å—Ç–æ—Ä–æ–Ω—É –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö.
–ú–µ–∂–¥—É traefic –∏ caddy –≤—ã–±—Ä–∞–ª –∏ –Ω–∞—Å—Ç—Ä–æ–∏–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π.
–°–Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ —Å dockerhub, –ø–æ—Ç–æ–º —Å–æ–±—Ä–∞–ª —Å–≤–æ–π (–≤ –≥–æ—Ç–æ–≤–æ–º —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–æ–±–ª–µ–º–æ–π, –¥–µ—Ç–∞–ª–µ–π –Ω–µ –ø–æ–º–Ω—é, –≤—Ä–æ–¥–µ –±—ã –∑–∞—Ö–æ—Ç–µ–ª Caddyfile –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π, –∞ –Ω–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ volume).

–ò–∑ –ø–ª—é—Å–æ–≤ caddy:
- –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–Ω—è—Ç–Ω–∞—è –∏ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- http/3 –∏ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π TLS
- —ç–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ prometheus
- –º–Ω–æ–≥–æ —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
- –ø–æ–¥–¥–µ—Ä–∂–∫–∞ healthcheck –¥–ª—è upstream-—Å–µ—Ä–≤–µ—Ä–æ–≤

–ú–∏–Ω—É—Å—ã:
 - –Ω–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑ –∫–æ—Ä–æ–±–∫–∏, –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—Ç—å —Å –º–æ–¥—É–ª—è–º–∏ (–ø—Ä–∏—à–ª–æ—Å—å üö≤ü¶Ø, —Å–º. [Caddyfile](caddy/Caddyfile), [Makefile](./Makefile) –∏ [–∫–æ–º–º–∏—Ç](https://github.com/ruckii/yyapp/commit/e0f3051bf7be4d966b4e232202ec7bc5c4fd9112))

## –ü–ª–∞–Ω–∏—Ä—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

–†–µ—à–µ–Ω–∏–µ –¥–µ–ª–∞—Ç—å –≤—Å—ë –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö –ø—Ä–∏–Ω—è—Ç–æ.

### –û–±—Ä–∞–∑—ã

–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä–æ–± –∏ –æ—à–∏–±–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –æ–±—Ä–∞–∑—ã:

- –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ [bitnami/postgresql](https://hub.docker.com/r/bitnami/postgresql) —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏
- —Å–æ–±–∏—Ä–∞—é init –æ–±—Ä–∞–∑ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ **bingo prepare_db** –Ω–∞ –±–∞–∑–µ gcr.io/distroless/static-debian12:nonroot
- —Å–æ–±–∏—Ä–∞—é –æ–±—Ä–∞–∑ –¥–ª—è **bingo run_server** –Ω–∞ –±–∞–∑–µ ubuntu
- –≤–µ–±-–ø—Ä–æ–∫—Å–∏ - —Å–Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É—é –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ [caddy](https://hub.docker.com/_/caddy), –ø–æ—Ç–æ–º —Å–æ–±–∏—Ä–∞—é —Å–≤–æ–π

### –¢–µ—Å—Ç—ã

–°—Ç–∞–≤–ª—é –∏ –ø—Ä–æ–±—É—é wrk. –†–∞–Ω–µ–µ, –∫–∞–∂–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ strace –∏ ld –≤—ã–≤–æ–¥–∞ –æ—Ç bingo –∑–∞–º–µ—Ç–∏–ª –Ω–∞–ª–∏—á–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥–∞ –¥–ª—è golang. –ù–∞ —Ç–µ—Å—Ç–∞—Ö –∑–∞–º–µ—á–∞—é, —á—Ç–æ RPS –æ—Ç –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ bingo –æ–≥—Ä–∞–Ω–∏—á–µ–Ω ~100. –ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¢–ó –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–ü–∏—à—É —Ç–µ—Å—Ç—ã –¥–ª—è wrk –Ω–∞ LuaJIT

- tests/api-customer-id.lua
- tests/api-customer.lua
- tests/api-movie-id.lua
- tests/api-movie.lua
- tests/api-session-id.lua
- tests/db_dummy.lua
- tests/operation.lua


–ó–∞–º–µ—á–∞—é, —á—Ç–æ bingo:
- –ø–∞–¥–∞–µ—Ç –ø–æ OOM
- `I feel bad` –≤–º–µ—Å—Ç–æ pong –Ω–∞ healthcheck

–î–æ–±–∞–≤–ª—è—é –ø—Ä–æ–≤–µ—Ä–∫—É –≤ docker-–æ–±—Ä–∞–∑ (—Å–Ω–∞—á–∞–ª–∞ –±—ã–ª —Ç–∞–π–º–∞—É—Ç ~35 —Å–µ–∫—É–Ω–¥, —á—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ–ª–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∏ –Ω–∞—á–∞—Ç—å –æ—Ç–¥–∞–≤–∞—Ç—å **pong**, –∫–æ–≥–¥–∞ —Ä–∞–∑–æ–±—Ä–∞–ª—Å—è —Å —É—Å–∫–æ—Ä–µ–Ω–∏–µ–º –∑–∞–ø—É—Å–∫–∞ - —É–º–µ–Ω—å—à–∏–ª —Ç–∞–π–º–∞—É—Ç—ã):

**bingo-server.Dockerfile**

```dockerfile
HEALTHCHECK --interval=5s --timeout=2s \
    CMD ./healthcheck.sh || kill 1 
```

**healthcheck.sh**
```bash
#!/bin/bash
STATUS=$(curl --silent http://localhost:4922/ping)
if [[ $STATUS == "pong" ]]; then
  echo "OK"
  exit 0
else
  echo "KO"
  exit 1
fi
```

–ü—Ä–∏–∫—Ä—É—á–∏–≤–∞—é `–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥` –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, –ø–æ—Å–ª–µ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ caddy:

```bash
#!/bin/bash

while true;
  do
  STATUS=$(curl --silent -k https://node-01.local/ping) # [OK] pong / [KO] I feel bad
  curl --fail --silent -k https://node-01.local/ping > /dev/null
  if [[ $? == 7 ]]; then
    echo -n "X"
  elif [[ $STATUS == "I feel bad" ]]; then
    echo -n "B"
  else
    echo -n "."
  fi
sleep 1;
done
```

–ò–∑—É—á–∞—é –∫–∞—Ä—Ç–∏–Ω—É –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ —Ç–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```
...........................................................BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB.............
................................................................................................BBBBBBBBBBBBBBB
BBBBBBBBBBBBBB.................................................................................................
...............................................................................................................
.......................................................................XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX..
...............................................................................................................
...............BB..............................................................................................
```



### –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è [2 –¥–Ω—è]

–°–Ω–∞—á–∞–ª–∞ –¥–µ–ª–∞–ª –≤—Å—ë –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –í–ú (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ –ø–æ–¥–Ω—è—Ç–∞—è –Ω–∞ —Å–≤—è–∑–∫–µ [Ubuntu Multipass + Windows 10 Hyper-V](https://multipass.run/docs/installing-on-windows#heading--hyper-v) - *–∫—Ä–∞–π–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é, –ø—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å—Ö–æ–¥–Ω–æ–π —Å WSL - –ª—É—á—à–∞—è –∏–∑–æ–ª—è—Ü–∏—è, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ docker*)

–ü–∏—à—É compose.yaml:

- –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –¥–µ–ª–∞—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∞
- –¥–µ–ª–∞—é healthcheck-–ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ–±—ã —Å–µ—Ä–≤–∏—Å—ã –Ω–µ –ø–æ–¥–Ω–∏–º–∞–ª–∏—Å—å —Ä–∞–Ω—å—à–µ, —á–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —Ç–µ, –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–≤–∏—Å—è—Ç (postgresql --> bingo-prepare-bd --> bingo-server --> caddy)
- –¥–æ–±–∞–≤–ª—è—é persistent-—Ç–æ–º –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ø—Ä–æ–±—É—é –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å bingo-server –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É

–•–æ—Ç–µ–ª –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞ Docker swarm-mode, –Ω–æ –æ—Ç–∫–∞–∑–∞–ª—Å—è –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è 3 –Ω–æ–¥—ã –¥–ª—è –∫–≤–æ—Ä—É–º–∞. –ù–∞ 2 –Ω–æ–¥–∞—Ö –º–æ–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å, –∏ –¥–∞–∂–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å—Ç—Ä–æ—è worker-–Ω–æ–¥—ã. –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–∏—Ç—å –Ω–æ–¥—É, –Ω–∞ –∫–æ–æ—Ä–æ–π controller - –≤—Å—ë –ø–∞–¥–∞–µ—Ç. –ù–µ–ø—Ä–∏–µ–º–ª–µ–º–æ.

–ö–æ–≥–¥–∞ –ø–æ–ª—É—á–∞—é –ø—Ä–∏–µ–º–ª–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å docker compose, –ø–ª–∞–Ω–∏—Ä—É—é —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Yandex Cloud.

_–ü—Ä–∏ —ç—Ç–æ–º –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏ –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ 1 –í–ú (2 GB RAM, 2 vCPU)._

### –¶–µ–ª–µ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ [1 –¥–µ–Ω—å]

_–°–º. –∫–∞—Ä—Ç–∏–Ω–∫—É –≤—ã—à–µ._

–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –í–ú, —Å–µ—Ç–∏, –ø–æ–¥—Å–µ—Ç–∏ c –ø–æ–º–æ—â—å—é Terraform.

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (CI/CD) [2 –¥–Ω—è]

–í—Ä–µ–º–µ–Ω–∏ –∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –±—ã–ª–æ –º–∞–ª–æ, GitHub Actions –ø–æ—Ç—ã–∫–∞–ª –ø–∞–ª–æ—á–∫–æ–π –∏ —Ä–µ—à–∏–ª –ø–æ —Å—Ç–∞—Ä–∏–Ω–∫–µ —á–µ—Ä–µ–∑ Makefile.
–û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–ª —Å —É—á—ë—Ç–æ–º master/slave —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø–æ–¥ Ubuntu 22.04.

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

git clone https://github.com/ruckii/yyapp

# 2. –°—Ç–∞–≤–∏–º make

sudo apt update
sudo apt install make

# 3. –î–µ–ª–∞–µ–º —Ä–∞–∑–Ω—ã–µ –≤–µ—â–∏ –∏—Å–ø–æ–ª—å–∑—É—è make

cd yyapp
make
'--> Bingo service <<The Hard Way>> <--'

# 4. –ù–∞–ø—Ä–∏–º–µ—Ä —Å—Ç–∞–≤–∏–º master –Ω–æ–¥—É
make master
#--‚úÇ--–∏–¥—ë—Ç —Ä–∞—Å–∫–∞—Ç–∫–∞ –∏ –ø–æ–¥–ø–∏–Ω—ã–≤–∞–Ω–∏–µ –Ω–æ–≥–æ–π--‚úÇ--

# 5. –ò–ª–∏ slave –Ω–æ–¥—É
make slave
#--‚úÇ--–∏–¥—ë—Ç —Ä–∞—Å–∫–∞—Ç–∫–∞ –∏ –ø–æ–¥–ø–∏–Ω—ã–≤–∞–Ω–∏–µ –Ω–æ–≥–æ–π--‚úÇ--

# 6. –ö–æ–≥–¥–∞ —É—Å—Ç–∞–ª–∏

make clean
#--‚úÇ--–∏–¥—ë—Ç —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å—è–∫–æ–≥–æ –∏ –∏–¥—ë–º —Å–Ω–æ–≤–∞ –Ω–∞ –ø—É–Ω–∫—Ç 4. –∏–ª–∏ 5.--‚úÇ--
```

–§–∏—á–∏ (—Ç–∞—Ä–≥–µ—Ç—ã):

- info - –Ω–µ –¥–æ–¥–µ–ª–∞–Ω–æ
- update/upgrade - –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–µ—à–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –û–°
- hostname-master/hostname-slave - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–º–µ–Ω–∏ —Ö–æ—Å—Ç–∞
- dns-resolver - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ avahi (zeroconf local DNS —Ä–µ–∑–æ–ª—å–≤–µ—Ä)
- ban-google - —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ bingo service
- cache-long-dummy - –∫–æ—Å—Ç—ã–ª—å–Ω–æ-–≤–µ–ª–æ—Å–∏–ø–µ–¥–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- test - –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ wrk
- docker - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—Å—Ç—Ä–æ–∫–∞ docker
- timesync - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º –∏–∑ —Å—Ç–∞—Ç—å–∏ Yandex Cloud
- downloads - —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ bingo –∏ caddy
- tools - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ wrk, yq
- build - —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤
- configure-master/configure-slave - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–æ–¥
- master/slave - –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ –Ω–æ–¥–∞—Ö
- passwords-master/passwords-slave - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –≤ –∫–æ–Ω—Ñ–∏–≥–∞—Ö postgres –∏ bingo, –ø—Ä–∏ —ç—Ç–æ–º –Ω–∞ slave-–Ω–æ–¥–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –ø–∞—Ä–æ–ª–∏ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–µ, —á—Ç–æ–±—ã –∫–ª–∞—Å—Ç–µ—Ä —Å–æ–±—Ä–∞–ª—Å—è
- clean - –æ—á–∏—Å—Ç–∫–∞ –æ—Ç –≤—Å—è–∫–∏—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (–Ω–µ –≤—Å–µ—Ö), –∑–∞–º–µ–Ω–∞ –ø–∞—Ä–æ–ª–µ–π –∑–∞–≥–ª—É—à–∫–∞–º–∏

# –†–∞–∑–Ω—ã–µ –≤–µ—â–∏

## –£—Å–∫–æ—Ä–µ–Ω–∏–µ —Å—Ç–∞—Ä—Ç–∞ [4 —á–∞—Å–∞]

–°–Ω–∞—á–∞–ª–∞ —è –¥—É–º–∞–ª, —á—Ç–æ –¥–æ–ª–≥–∏–π —Å—Ç–∞—Ä—Ç —ç—Ç–æ –Ω–æ—Ä–º–∞. –ü–æ—Ç–æ–º –Ω–∞—à—ë–ª –∫–æ–¥, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ bingo –≤ –±–ª–æ–∫–Ω–æ—Ç–µ. –î–∞–ª–µ–µ –Ω–∞—à—ë–ª http://8.8.8.8 –≤ —Å—Ç—Ä–æ–∫–∞—Ö –±–∏–Ω–∞—Ä–Ω–∏–∫–∞, –æ—Ç–∫—Ä—ã–ª –∏ —É–≤–∏–¥–µ–ª —Ç–∞–π–º–∞—É—Ç. 

–î–∞–ª–µ–µ:

```bash
ip route add blackhole 8.8.8.8
```

## Avahi - zeroconf –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–º—ë–Ω (*.local)

sudo apt install avahi-daemon
sudo systemctl start avahi-daemon
sudo systemctl status avahi-daemon
sudo systemctl enable avahi-daemon

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ë–î [1 –¥–µ–Ω—å]

–ó–∞–ø—É—Å–∫–∞—é DBeaver –∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø—Ä–æ–≥–æ–Ω–∫–∏ —Ç–µ—Å—Ç–æ–≤ —Å–º–æ—Ç—Ä—é —Å–µ—Å—Å–∏–∏ –∏ —Å–æ–±–∏—Ä–∞—é –∑–∞–ø—Ä–æ—Å—ã. –ó–∞–ø—É—Å–∫–∞—é –≤—Ä—É—á–Ω—É—é —Å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∫–æ–π.

```sql
explain (analyze,verbose on)
```
–°–º–æ—Ç—Ä—é –ø–ª–∞–Ω—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, –¥–æ–±–∞–≤–ª—è—é –∏–Ω–¥–µ–∫—Å—ã –∏/–∏–ª–∏ –ø–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏.

–°–∞–º–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –±—ã–ª–∞ —Å _GET /sessions_ - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–ª –ø–æ —à–∞–≥–∞–º, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è—è JOIN –∏ ORDER, –ø–æ–ø—É—Ç–Ω–æ —Å–æ–∑–¥–∞–≤–∞—è –∏–Ω–¥–µ–∫—Å—ã.

#### –ü–æ–≤–æ—Ä–æ—Ç –Ω–µ —Ç—É–¥–∞

–ü–æ–ø—É—Ç–Ω–æ –ø–æ—à—ë–ª –ø–æ –∫—Ä–∏–≤–æ–π –¥–æ—Ä–æ–∂–∫–µ, –ø–æ–ø—Ä–æ–±–æ–≤–∞–≤ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É **sessions** –∏ –¥—Ä—É–≥–∏–µ, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –æ–Ω–∞ —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –≤ columnar _table_. 
–î–ª—è —ç—Ç–æ–≥–æ –ë–î —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–ª –Ω–∞ –≥–æ—Ç–æ–≤–æ–º –æ–±—Ä–∞–∑–µ [citusdata/citus](https://hub.docker.com/r/citusdata/citus). –¢–∞–∫–∂–µ, –º–Ω–æ–≥–æ –¥—É–º–∞–ª –Ω–∞ —Ç–µ–º—É —à–∞—Ä–¥–∏–Ω–≥–∞ —Ç–∞–±–ª–∏—Ü –ø–æ –¥–≤—É–º –Ω–æ–¥–∞–º.

```sql
-- —Å–æ–∑–¥–∞—ë–º —Ü–µ–ª–µ–≤—É—é columnar —Ç–∞–±–ª–∏—Ü—É
CREATE TABLE public.customers_col (
	id int4 NOT NULL DEFAULT nextval('customers_id_seq'::regclass),
	"name" varchar(80) NOT NULL,
	surname varchar(80) NOT NULL,
	birthday date NOT NULL,
	email varchar(256) NOT NULL,
	CONSTRAINT customers_pk PRIMARY KEY (id)
) USING columnar;

-- –∫–æ–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π
INSERT INTO customers_col
SELECT * FROM customers;

-- –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º, –∏—Å—Ö–æ–¥–Ω—É—é –∏ —Ü–µ–ª–µ–≤—É—é, –º–µ–Ω—è—è –∏—Ö –º–µ—Å—Ç–∞–º–∏
...
```

Columnar —Ç–∞–±–ª–∏—Ü—ã –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–µ —Å–∏–ª—å–Ω–æ –≤—ã–∏–≥—Ä—ã–≤–∞–ª–∏ –Ω–∞ —Ç–µ–∫—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö —É row-based, —á—Ç–æ, –≤ –ø—Ä–æ—á–µ–º –±—ã–ª–æ –æ–∂–∏–¥–∞–µ–º–æ, —Ö–æ—Ç—è –±—ã–ª–∞ –Ω–∞–¥–µ–∂–¥–∞ —á—Ç–æ –∑–∞ —Å—á—ë—Ç —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ë–î –æ–Ω–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø–∞–º—è—Ç–∏.

#### –†–µ–∑—É–ª—å—Ç–∞—Ç

–í –∏—Ç–æ–≥–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–ª –∏—Å—Ö–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, —á—Ç–æ–±—ã –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –æ—Ç–≤–∞–ª–∏–≤–∞–ª–∏—Å—å –ø–æ —Ç–∞–π–º–∞—É—Ç—É.

–í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
```sql
-- PK
ALTER TABLE public.sessions ADD CONSTRAINT sessions_pk PRIMARY KEY (id);
ALTER TABLE public.customers ADD CONSTRAINT customers_pk PRIMARY KEY (id);
ALTER TABLE public.movies ADD CONSTRAINT movies_pk PRIMARY KEY (id);
-- Indexes
CREATE INDEX sessions_movie_id_idx ON public.sessions USING btree (movie_id);
CREATE INDEX movies_year_name_idx ON public.movies USING btree (year DESC, name);
CREATE INDEX customers_surname_idx ON public.customers (surname,"name",birthday DESC,id DESC);
CREATE INDEX movies_year_idx ON public.movies ("year" DESC,"name",id DESC);
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- Yandex Monitoring –¥–ª—è VM (–¥–∏—Å–∫–∏, CPU), NLB (–ø–∞–∫–µ—Ç—ã)
- Grafana+Prometheus –¥–ª—è caddy (–Ω–∞ –¥–æ–º–∞—à–Ω–µ–º –ü–ö), —á—Ç–æ–±—ã —Å–ª–µ–¥–∏—Ç—å –∑–∞ RPS, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—à–∏–±–∫–∞–º–∏ HTTP

![2023-12-02 00 12 49 monitoring cloud yandex ru e91198affb25](https://github.com/ruckii/yyapp/assets/1169824/2dcd5e06-8949-46dd-8168-ac4dcedfc938)

![2023-12-02 00 09 25 primary local f59b2a848502](https://github.com/ruckii/yyapp/assets/1169824/cad2c218-5ae0-4451-9cd7-9d7c64bb75f8)

## –ò—Ç–æ–≥–æ–≤—ã–µ end-to-end —Ç–µ—Å—Ç—ã

![2023-11-30 15 26 52 devops yactf ru 93a7e9d12492](https://github.com/ruckii/yyapp/assets/1169824/15bf7149-e420-48a4-9822-e2c2d196b4d3)

# English version

## Deployment steps

1. Clone repository
```
git clone https://github.com/ruckii/yyapp
```

2. Install **make** utility
```
sudo apt update
sudo apt install make
```
3. Do other stuff using **make**
```
cd yyapp
make
```
